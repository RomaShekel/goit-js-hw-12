{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst lightbox = new SimpleLightbox('.gallery a');\nconst form = document.querySelector(\"form\");\nconst input = document.querySelector(\".input\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader-container\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\");\n\nlet currentPage = 1;\nlet currentQuery = \"\";\n\nlet totalHits = 0; //змінна збігів\n\nform.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  currentQuery = input.value;\n  currentPage = 1;\n  loader.classList.add(\"hidden\");\n  loadMoreBtn.classList.remove(\"load-more-btn-active\");\n\n  try {\n    const data = await searchImages(currentQuery, currentPage);\n\n    totalHits = data.totalHitshits || 0;\n\n    if (data.hits.length > 0) {\n      clearGallery();\n      addImagesToGallery(data.hits);\n    } else {\n      iziToast.error({\n        title: \"Error\",\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n      });\n    }\n  } catch (error) {\n    loader.classList.remove(\"hidden\");\n    iziToast.error({\n      title: \"Error\",\n      message: \"Sorry, there was an error. Please try again later.\",\n    });\n    console.error(\"Error:\", error);\n  }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  currentPage++;\n  loader.classList.add(\"hidden\");\n  loadMoreBtn.classList.remove(\"load-more-btn-active\");\n\n  try {\n    const data = await searchImages(currentQuery, currentPage);\n\n    if (data.hits.length > 0) {\n      addImagesToGallery(data.hits);\n      smoothScroll(260 * 2);\n    }\n\n    const totalPages = Math.ceil(totalHits / 40);\n\n  if (currentPage > totalPages) {\n    loadMoreBtn.classList.remove(\"load-more-btn-active\");\n    iziToast.info({\n      title: \"End of Collection\",\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n\n  } catch (error) {\n    loader.classList.remove(\"hidden\");\n    iziToast.error({\n      title: \"Error\",\n      message: \"Sorry, there was an error. Please try again later.\",\n    });\n    console.error(\"Error:\", error);\n  }\n});\n\nasync function searchImages(query, page) {\n  try {\n    const apiKey = \"41928884-dc2fda080aeeea262233bfc7c\";\n    const apiUrl = \"https://pixabay.com/api/\";\n    const perPage = 40;\n    const requestUrl = `${apiUrl}?key=${apiKey}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n    const response = await axios.get(requestUrl);\n\n    if (!response.data || response.data.hits.length === 0) {\n      throw new Error(\"Invalid response from the server\");\n    }\n\n    return response.data;\n  } catch (error) {\n    throw new Error(`Failed to fetch images: ${error.message}`);\n  }\n}\n\nfunction addImagesToGallery(images) {\n  loader.classList.remove(\"hidden\");\n  images.forEach((image) => {\n    const cardMarkup = `\n      <a href=\"${image.largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${image.tags}\">\n        <li class=\"card\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"card-img\">\n          <div class=\"card-info\">\n            <div class=\"div-info\">\n              <p>Likes <span>${image.likes}</span></p>\n            </div>\n            <div class=\"div-info\">\n              <p>Views <span>${image.views}</span></p>\n            </div>\n            <div class=\"div-info\">\n              <p>Comments <span>${image.comments}</span></p>\n            </div>\n            <div class=\"div-info\">\n              <p>Downloads <span>${image.downloads}</span></p>\n            </div>\n          </div>\n        </li>\n      </a>\n    `;\n\n    gallery.insertAdjacentHTML(\"beforeend\", cardMarkup);\n  });\n  loadMoreBtn.classList.add(\"load-more-btn-active\");\n\n\n  lightbox.refresh();\n\n\n  // const totalPages = Math.ceil(totalHits / 120);\n  // const isLastPage = currentPage === totalPages;\n\n  // if (isLastPage) {\n  //   loadMoreBtn.classList.remove(\"load-more-btn-active\");\n  //   iziToast.info({\n  //     title: \"End of Collection\",\n  //     message: \"We're sorry, but you've reached the end of search results.\",\n  //   });\n  // }\n\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = \"\";\n}\n\nfunction smoothScroll(distance) {\n  window.scrollBy({\n    top: distance,\n    behavior: \"smooth\",\n  });\n}\n\n"],"names":["lightbox","SimpleLightbox","form","input","gallery","loader","loadMoreBtn","currentPage","currentQuery","totalHits","event","data","searchImages","clearGallery","addImagesToGallery","iziToast","error","smoothScroll","totalPages","query","page","requestUrl","response","axios","images","image","cardMarkup","distance"],"mappings":"owBAMA,MAAMA,EAAW,IAAIC,EAAe,YAAY,EAC1CC,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAQ,SAAS,cAAc,QAAQ,EACvCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,mBAAmB,EACnDC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,IAAIC,EAAc,EACdC,EAAe,GAEfC,EAAY,EAEhBP,EAAK,iBAAiB,SAAU,MAAOQ,GAAU,CAC/CA,EAAM,eAAc,EACpBF,EAAeL,EAAM,MACrBI,EAAc,EACdF,EAAO,UAAU,IAAI,QAAQ,EAC7BC,EAAY,UAAU,OAAO,sBAAsB,EAEnD,GAAI,CACF,MAAMK,EAAO,MAAMC,EAAaJ,EAAcD,CAAW,EAEzDE,EAAYE,EAAK,eAAiB,EAE9BA,EAAK,KAAK,OAAS,GACrBE,IACAC,EAAmBH,EAAK,IAAI,GAE5BI,EAAS,MAAM,CACb,MAAO,QACP,QAAS,0EACjB,CAAO,CAEJ,OAAQC,EAAP,CACAX,EAAO,UAAU,OAAO,QAAQ,EAChCU,EAAS,MAAM,CACb,MAAO,QACP,QAAS,oDACf,CAAK,EACD,QAAQ,MAAM,SAAUC,CAAK,CAC9B,CACH,CAAC,EAEDV,EAAY,iBAAiB,QAAS,SAAY,CAChDC,IACAF,EAAO,UAAU,IAAI,QAAQ,EAC7BC,EAAY,UAAU,OAAO,sBAAsB,EAEnD,GAAI,CACF,MAAMK,EAAO,MAAMC,EAAaJ,EAAcD,CAAW,EAErDI,EAAK,KAAK,OAAS,IACrBG,EAAmBH,EAAK,IAAI,EAC5BM,EAAa,IAAM,CAAC,GAGtB,MAAMC,EAAa,KAAK,KAAKT,EAAY,EAAE,EAEzCF,EAAcW,IAChBZ,EAAY,UAAU,OAAO,sBAAsB,EACnDS,EAAS,KAAK,CACZ,MAAO,oBACP,QAAS,4DACf,CAAK,EAGF,OAAQC,EAAP,CACAX,EAAO,UAAU,OAAO,QAAQ,EAChCU,EAAS,MAAM,CACb,MAAO,QACP,QAAS,oDACf,CAAK,EACD,QAAQ,MAAM,SAAUC,CAAK,CAC9B,CACH,CAAC,EAED,eAAeJ,EAAaO,EAAOC,EAAM,CACvC,GAAI,CAIF,MAAMC,EAAa,qEAA6BF,kEAAsEC,cAAiB,KAEjIE,EAAW,MAAMC,EAAM,IAAIF,CAAU,EAE3C,GAAI,CAACC,EAAS,MAAQA,EAAS,KAAK,KAAK,SAAW,EAClD,MAAM,IAAI,MAAM,kCAAkC,EAGpD,OAAOA,EAAS,IACjB,OAAQN,EAAP,CACA,MAAM,IAAI,MAAM,2BAA2BA,EAAM,SAAS,CAC3D,CACH,CAEA,SAASF,EAAmBU,EAAQ,CAClCnB,EAAO,UAAU,OAAO,QAAQ,EAChCmB,EAAO,QAASC,GAAU,CACxB,MAAMC,EAAa;AAAA,iBACND,EAAM,sDAAsDA,EAAM;AAAA;AAAA,sBAE7DA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA,+BAGzBA,EAAM;AAAA;AAAA;AAAA,+BAGNA,EAAM;AAAA;AAAA;AAAA,kCAGHA,EAAM;AAAA;AAAA;AAAA,mCAGLA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,MAOrCrB,EAAQ,mBAAmB,YAAasB,CAAU,CACtD,CAAG,EACDpB,EAAY,UAAU,IAAI,sBAAsB,EAGhDN,EAAS,QAAO,CAclB,CAEA,SAASa,GAAe,CACtBT,EAAQ,UAAY,EACtB,CAEA,SAASa,EAAaU,EAAU,CAC9B,OAAO,SAAS,CACd,IAAKA,EACL,SAAU,QACd,CAAG,CACH"}