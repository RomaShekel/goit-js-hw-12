{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst form = document.querySelector(\"form\");\nconst input = document.querySelector(\".input\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader-container\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\");\n\nlet currentPage = 1;\nlet currentQuery = \"\";\n\nform.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  currentQuery = input.value;\n  currentPage = 1;\n  loader.classList.add(\"visibility\");\n  loadMoreBtn.classList.remove(\"load-more-btn-active\");\n  try {\n    const data = await searchImages(currentQuery, currentPage);\n    if (data.hits.length > 0) {\n      clearGallery();\n      addImagesToGallery(data.hits);\n    } else {\n      iziToast.error({\n        title: \"Error\",\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n      });\n    }\n  } catch (error) {\n    loader.classList.remove(\"visibility\");\n    iziToast.error({\n      title: \"Error\",\n      message: \"Sorry, there was an error. Please try again later.\",\n    });\n    console.error(\"Error:\", error);\n  }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  currentPage++;\n  loader.classList.add(\"visibility\");\n  loadMoreBtn.classList.remove(\"load-more-btn-active\");\n  try {\n    const data = await searchImages(currentQuery, currentPage);\n    if (data.hits.length > 0) {\n      addImagesToGallery(data.hits);\n      smoothScroll(260 * 2);\n    }\n  } catch (error) {\n    loader.classList.remove(\"visibility\");\n    iziToast.error({\n      title: \"Error\",\n      message: \"Sorry, there was an error. Please try again later.\",\n    });\n    console.error(\"Error:\", error);\n  }\n});\n\nasync function searchImages(query, page) {\n  try {\n    const apiKey = \"41928884-dc2fda080aeeea262233bfc7c\";\n    const apiUrl = \"https://pixabay.com/api/\";\n    const perPage = 40;\n    const requestUrl = `${apiUrl}?key=${apiKey}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n    const response = await axios.get(requestUrl);\n\n    if (!response.data.hits) {\n      throw new Error(\"Invalid response from the server\");\n    }\n\n    return response.data;\n  } catch (error) {\n    throw new Error(`Failed to fetch images: ${error.message}`);\n  }\n}\n\nfunction addImagesToGallery(images) {\n  loader.classList.remove(\"visibility\");\n  images.forEach((image) => {\n    const cardMarkup = `\n      <a href=\"${image.largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${image.tags}\">\n        <li class=\"card\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"card-img\">\n          <div class=\"card-info\">\n            <div class=\"div-info\">\n              <p>Likes <span>${image.likes}</span></p>\n            </div>\n            <div class=\"div-info\">\n              <p>Views <span>${image.views}</span></p>\n            </div>\n            <div class=\"div-info\">\n              <p>Comments <span>${image.comments}</span></p>\n            </div>\n            <div class=\"div-info\">\n              <p>Downloads <span>${image.downloads}</span></p>\n            </div>\n          </div>\n        </li>\n      </a>\n    `;\n\n    gallery.insertAdjacentHTML(\"beforeend\", cardMarkup);\n  });\n  loadMoreBtn.classList.add(\"load-more-btn-active\");\n\n  const lightbox = new SimpleLightbox('.gallery a');\n  lightbox.refresh();\n\n  const totalHits = 120;\n  const totalPages = Math.ceil(totalHits / 40);\n  const isLastPage = currentPage === totalPages;\n\n  if (isLastPage) {\n    loadMoreBtn.classList.remove(\"load-more-btn-active\");\n    iziToast.info({\n      title: \"End of Collection\",\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = \"\";\n}\n\nfunction smoothScroll(distance) {\n  window.scrollBy({\n    top: distance,\n    behavior: \"smooth\",\n  });\n}\n\n"],"names":["form","input","gallery","loader","loadMoreBtn","currentPage","currentQuery","event","data","searchImages","clearGallery","addImagesToGallery","iziToast","error","smoothScroll","query","page","requestUrl","response","axios","images","image","cardMarkup","SimpleLightbox","totalPages","distance"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAQ,SAAS,cAAc,QAAQ,EACvCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,mBAAmB,EACnDC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,IAAIC,EAAc,EACdC,EAAe,GAEnBN,EAAK,iBAAiB,SAAU,MAAOO,GAAU,CAC/CA,EAAM,eAAc,EACpBD,EAAeL,EAAM,MACrBI,EAAc,EACdF,EAAO,UAAU,IAAI,YAAY,EACjCC,EAAY,UAAU,OAAO,sBAAsB,EACnD,GAAI,CACF,MAAMI,EAAO,MAAMC,EAAaH,EAAcD,CAAW,EACrDG,EAAK,KAAK,OAAS,GACrBE,IACAC,EAAmBH,EAAK,IAAI,GAE5BI,EAAS,MAAM,CACb,MAAO,QACP,QAAS,0EACjB,CAAO,CAEJ,OAAQC,EAAP,CACAV,EAAO,UAAU,OAAO,YAAY,EACpCS,EAAS,MAAM,CACb,MAAO,QACP,QAAS,oDACf,CAAK,EACD,QAAQ,MAAM,SAAUC,CAAK,CAC9B,CACH,CAAC,EAEDT,EAAY,iBAAiB,QAAS,SAAY,CAChDC,IACAF,EAAO,UAAU,IAAI,YAAY,EACjCC,EAAY,UAAU,OAAO,sBAAsB,EACnD,GAAI,CACF,MAAMI,EAAO,MAAMC,EAAaH,EAAcD,CAAW,EACrDG,EAAK,KAAK,OAAS,IACrBG,EAAmBH,EAAK,IAAI,EAC5BM,EAAa,IAAM,CAAC,EAEvB,OAAQD,EAAP,CACAV,EAAO,UAAU,OAAO,YAAY,EACpCS,EAAS,MAAM,CACb,MAAO,QACP,QAAS,oDACf,CAAK,EACD,QAAQ,MAAM,SAAUC,CAAK,CAC9B,CACH,CAAC,EAED,eAAeJ,EAAaM,EAAOC,EAAM,CACvC,GAAI,CAIF,MAAMC,EAAa,qEAA6BF,kEAAsEC,cAAiB,KAEjIE,EAAW,MAAMC,EAAM,IAAIF,CAAU,EAE3C,GAAI,CAACC,EAAS,KAAK,KACjB,MAAM,IAAI,MAAM,kCAAkC,EAGpD,OAAOA,EAAS,IACjB,OAAQL,EAAP,CACA,MAAM,IAAI,MAAM,2BAA2BA,EAAM,SAAS,CAC3D,CACH,CAEA,SAASF,EAAmBS,EAAQ,CAClCjB,EAAO,UAAU,OAAO,YAAY,EACpCiB,EAAO,QAASC,GAAU,CACxB,MAAMC,EAAa;AAAA,iBACND,EAAM,sDAAsDA,EAAM;AAAA;AAAA,sBAE7DA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA,+BAGzBA,EAAM;AAAA;AAAA;AAAA,+BAGNA,EAAM;AAAA;AAAA;AAAA,kCAGHA,EAAM;AAAA;AAAA;AAAA,mCAGLA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,MAOrCnB,EAAQ,mBAAmB,YAAaoB,CAAU,CACtD,CAAG,EACDlB,EAAY,UAAU,IAAI,sBAAsB,EAE/B,IAAImB,EAAe,YAAY,EACvC,QAAO,EAGhB,MAAMC,EAAa,KAAK,KADN,IACuB,EAAE,EACxBnB,IAAgBmB,IAGjCpB,EAAY,UAAU,OAAO,sBAAsB,EACnDQ,EAAS,KAAK,CACZ,MAAO,oBACP,QAAS,4DACf,CAAK,EAGL,CAEA,SAASF,GAAe,CACtBR,EAAQ,UAAY,EACtB,CAEA,SAASY,EAAaW,EAAU,CAC9B,OAAO,SAAS,CACd,IAAKA,EACL,SAAU,QACd,CAAG,CACH"}