{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst lightbox = new SimpleLightbox('.gallery a');\nconst form = document.querySelector(\"form\");\nconst input = document.querySelector(\".input\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader-container\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\");\n\nlet currentPage = 1;\nlet currentQuery = \"\";\nlet totalHits = 0;\n\nform.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  currentQuery = input.value;\n  currentPage = 1;\n  loaderAddVisible();\n  loadMoreBtnInactive()\n  clearGallery();\n  try {\n    const data = await searchImages(currentQuery, currentPage);\n    totalHits = data.totalhits || 0;\n\n    if (data.hits.length > 0) {\n      addImagesToGallery(data.hits);\n    } else {\n      iziToast.error({\n        title: \"Error\",\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n      });\n    }\n  } catch (error) {\n    loaderRemoveVisible();\n    iziToast.error({\n      title: \"Error\",\n      message: \"Sorry, there was an error. Please try again later.\",\n    });\n    console.error(\"Error:\", error);\n  }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  currentPage++;\n  loaderAddVisible();\n  loadMoreBtnInactive();\n\n  try {\n    const data = await searchImages(currentQuery, currentPage);\n\n    if (data.hits.length > 0) {\n      addImagesToGallery(data.hits);\n      smoothScroll(260 * 2);\n    }\n    const totalPages = Math.ceil(totalHits / perPage);\n\n  if (currentPage > totalPages) {\n    loadMoreBtnInactive();\n    iziToast.info({\n      title: \"End of Collection\",\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n  } catch (error) {\n    loaderRemoveVisible();\n    iziToast.error({\n      title: \"Error\",\n      message: \"Sorry, there was an error. Please try again later.\",\n    });\n    console.error(\"Error:\", error);\n  }\n});\n\nconst perPage = 40;\nasync function searchImages(query, page) {\n  try {\n    const apiKey = \"41928884-dc2fda080aeeea262233bfc7c\";\n    const apiUrl = \"https://pixabay.com/api/\";\n    const requestUrl = `${apiUrl}?key=${apiKey}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n    const response = await axios.get(requestUrl);\n\n    if (!response.data || response.data.hits.length === 0) {\n      throw new Error(\"Invalid response from the server\");\n    }\n    return response.data;\n  } catch (error) {\n    throw new Error(`Failed to fetch images: ${error.message}`);\n  }\n}\n\nfunction addImagesToGallery(images) {\n  loaderRemoveVisible();\n  images.forEach((image) => {\n    const cardMarkup = `\n      <a href=\"${image.largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${image.tags}\">\n        <li class=\"card\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"card-img\">\n          <div class=\"card-info\">\n            <div class=\"div-info\">\n              <p>Likes <span>${image.likes}</span></p>\n            </div>\n            <div class=\"div-info\">\n              <p>Views <span>${image.views}</span></p>\n            </div>\n            <div class=\"div-info\">\n              <p>Comments <span>${image.comments}</span></p>\n            </div>\n            <div class=\"div-info\">\n              <p>Downloads <span>${image.downloads}</span></p>\n            </div>\n          </div>\n        </li>\n      </a>\n    `;\n\n    gallery.insertAdjacentHTML(\"beforeend\", cardMarkup);\n  });\n  loadMoreBtnActive();\n  lightbox.refresh();\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = \"\";\n}\n\nfunction smoothScroll(distance) {\n  window.scrollBy({\n    top: distance,\n    behavior: \"smooth\",\n  });\n}\n\nfunction loadMoreBtnActive() {\n  loadMoreBtn.classList.add(\"load-more-btn-active\");\n};\n\nfunction loadMoreBtnInactive() {\n  loadMoreBtn.classList.remove(\"load-more-btn-active\");\n};\n\nfunction loaderAddVisible() {\n  loader.classList.add(\"visible\");\n};\n\nfunction loaderRemoveVisible() {\n  loader.classList.remove(\"visible\");\n};\n\n"],"names":["lightbox","SimpleLightbox","form","input","gallery","loader","loadMoreBtn","currentPage","currentQuery","totalHits","event","loaderAddVisible","loadMoreBtnInactive","clearGallery","data","searchImages","addImagesToGallery","iziToast","error","loaderRemoveVisible","smoothScroll","totalPages","perPage","query","page","requestUrl","response","axios","images","image","cardMarkup","loadMoreBtnActive","distance"],"mappings":"owBAMA,MAAMA,EAAW,IAAIC,EAAe,YAAY,EAC1CC,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAQ,SAAS,cAAc,QAAQ,EACvCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,mBAAmB,EACnDC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,IAAIC,EAAc,EACdC,EAAe,GACfC,EAAY,EAEhBP,EAAK,iBAAiB,SAAU,MAAOQ,GAAU,CAC/CA,EAAM,eAAc,EACpBF,EAAeL,EAAM,MACrBI,EAAc,EACdI,IACAC,EAAqB,EACrBC,IACA,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAaP,EAAcD,CAAW,EACzDE,EAAYK,EAAK,WAAa,EAE1BA,EAAK,KAAK,OAAS,EACrBE,EAAmBF,EAAK,IAAI,EAE5BG,EAAS,MAAM,CACb,MAAO,QACP,QAAS,0EACjB,CAAO,CAEJ,OAAQC,EAAP,CACAC,IACAF,EAAS,MAAM,CACb,MAAO,QACP,QAAS,oDACf,CAAK,EACD,QAAQ,MAAM,SAAUC,CAAK,CAC9B,CACH,CAAC,EAEDZ,EAAY,iBAAiB,QAAS,SAAY,CAChDC,IACAI,IACAC,IAEA,GAAI,CACF,MAAME,EAAO,MAAMC,EAAaP,EAAcD,CAAW,EAErDO,EAAK,KAAK,OAAS,IACrBE,EAAmBF,EAAK,IAAI,EAC5BM,EAAa,IAAM,CAAC,GAEtB,MAAMC,EAAa,KAAK,KAAKZ,EAAYa,CAAO,EAE9Cf,EAAcc,IAChBT,IACAK,EAAS,KAAK,CACZ,MAAO,oBACP,QAAS,4DACf,CAAK,EAEF,OAAQC,EAAP,CACAC,IACAF,EAAS,MAAM,CACb,MAAO,QACP,QAAS,oDACf,CAAK,EACD,QAAQ,MAAM,SAAUC,CAAK,CAC9B,CACH,CAAC,EAED,MAAMI,EAAU,GAChB,eAAeP,EAAaQ,EAAOC,EAAM,CACvC,GAAI,CAGF,MAAMC,EAAa,qEAA6BF,kEAAsEC,cAAiBF,IAEjII,EAAW,MAAMC,EAAM,IAAIF,CAAU,EAE3C,GAAI,CAACC,EAAS,MAAQA,EAAS,KAAK,KAAK,SAAW,EAClD,MAAM,IAAI,MAAM,kCAAkC,EAEpD,OAAOA,EAAS,IACjB,OAAQR,EAAP,CACA,MAAM,IAAI,MAAM,2BAA2BA,EAAM,SAAS,CAC3D,CACH,CAEA,SAASF,EAAmBY,EAAQ,CAClCT,IACAS,EAAO,QAASC,GAAU,CACxB,MAAMC,EAAa;AAAA,iBACND,EAAM,sDAAsDA,EAAM;AAAA;AAAA,sBAE7DA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA,+BAGzBA,EAAM;AAAA;AAAA;AAAA,+BAGNA,EAAM;AAAA;AAAA;AAAA,kCAGHA,EAAM;AAAA;AAAA;AAAA,mCAGLA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,MAOrCzB,EAAQ,mBAAmB,YAAa0B,CAAU,CACtD,CAAG,EACDC,IACA/B,EAAS,QAAO,CAClB,CAEA,SAASa,GAAe,CACtBT,EAAQ,UAAY,EACtB,CAEA,SAASgB,EAAaY,EAAU,CAC9B,OAAO,SAAS,CACd,IAAKA,EACL,SAAU,QACd,CAAG,CACH,CAEA,SAASD,GAAoB,CAC3BzB,EAAY,UAAU,IAAI,sBAAsB,CAClD,CAEA,SAASM,GAAsB,CAC7BN,EAAY,UAAU,OAAO,sBAAsB,CACrD,CAEA,SAASK,GAAmB,CAC1BN,EAAO,UAAU,IAAI,SAAS,CAChC,CAEA,SAASc,GAAsB,CAC7Bd,EAAO,UAAU,OAAO,SAAS,CACnC"}